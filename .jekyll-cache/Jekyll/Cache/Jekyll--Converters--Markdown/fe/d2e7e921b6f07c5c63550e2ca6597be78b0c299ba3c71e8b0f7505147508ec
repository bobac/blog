I"İ<p>V praxi nenÃ­ nic neobvyklÃ©ho, kdyÅ¾ po instalaci Azure AD Connect najdete v AD pÃ¡r podivnÃ½ch ÃºÄtÅ¯, kterÃ© na prvnÃ­ pohled nedÃ¡vajÃ­ smysl. Tato konverzace objasnila, co je co, a proÄ nÄ›kdy mÅ¯Å¾e nastat problÃ©m pÅ™i pÅ™idÃ¡vÃ¡nÃ­ tÄ›chto ÃºÄtÅ¯ do skupin podle internÃ­ch politik.</p>

<h2 id="co-vlastnÄ›-azure-ad-connect-vytvÃ¡Å™Ã­">Co vlastnÄ› Azure AD Connect vytvÃ¡Å™Ã­</h2>
<h3 id="1-adsyncmsaxxxx--definice-gmsa">1. <strong>ADSyncMSAxxxx</strong> â€“ definice gMSA</h3>
<p>Tohle je objekt typu <em>Group Managed Service Account</em>. NenÃ­ to bÄ›Å¾nÃ½ uÅ¾ivatelskÃ½ ÃºÄet a nemÅ¯Å¾e se pÅ™ihlÃ¡sit. Je to jen â€hlaviÄkaâ€œ ÃºÄtu, kterou Active Directory pouÅ¾Ã­vÃ¡ k Å™Ã­zenÃ­ hesel a atributÅ¯.</p>

<h3 id="2-adsyncmsaxxxx--skuteÄnÃ½-bezpeÄnostnÃ­-principal">2. <strong>ADSyncMSAxxxx$</strong> â€“ skuteÄnÃ½ bezpeÄnostnÃ­ principal</h3>
<p>SluÅ¾ba â€Microsoft Azure AD Syncâ€œ bÄ›Å¾Ã­ prÃ¡vÄ› pod tÃ­mto ÃºÄtem.<br />
Je to reÃ¡lnÃ½ logon ÃºÄet a mÃ¡ <code class="language-plaintext highlighter-rouge">$</code> stejnÄ› jako poÄÃ­taÄovÃ© ÃºÄty.<br />
V konzoli MMC ho ale Äasto vÅ¯bec neuvidÃ­te, coÅ¾ mate sprÃ¡vce.</p>

<h3 id="3-msol_xxxxxxx--starÃ½-service-account">3. <strong>MSOL_xxxxxxx</strong> â€“ starÃ½ service account</h3>
<p>Tohle je ÃºÄet ze starÅ¡Ã­ verze AAD Connect. ModernÃ­ instalace uÅ¾ tento ÃºÄet nepouÅ¾Ã­vajÃ­, ale ÃºÄet v AD zÅ¯stÃ¡vÃ¡ jako pozÅ¯statek. NemÃ¡ vztah k souÄasnÃ©mu gMSA ÃºÄtu.</p>

<h2 id="proÄ-nejde-ÃºÄet-najÃ­t-v-ad">ProÄ nejde ÃºÄet najÃ­t v AD</h2>
<p>MMC (dsa.msc) neumÃ­ zobrazit gMSA tak, jak by ÄlovÄ›k Äekal.<br />
VidÃ­te prÃ¡zdnÃ½ kontejner, nevidÃ­te <code class="language-plaintext highlighter-rouge">$</code> ÃºÄet, ale Azure AD Sync sluÅ¾ba pod nÃ­m bÄ›Å¾Ã­.</p>

<p>Å˜eÅ¡enÃ­m je:</p>
<ul>
  <li>pouÅ¾Ã­t PowerShell,</li>
  <li>nebo pouÅ¾Ã­t ADAC (kterÃ½ gMSA zobrazuje sprÃ¡vnÄ›).</li>
</ul>

<h2 id="jak-pÅ™idat-adsync-gmsa-do-skupiny">Jak pÅ™idat ADSync gMSA do skupiny</h2>
<p>InternÃ­ politika vyÅ¾aduje, aby vÅ¡echny ÃºÄty sluÅ¾eb byly Älenem urÄitÃ© skupiny â€” napÅ™Ã­klad <em>grpservice</em>.<br />
Proto je potÅ™eba pÅ™idat <strong>ADSyncMSAxxxx$</strong>.</p>

<p>PowerShell Å™eÅ¡Ã­ situaci okamÅ¾itÄ›:</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Add-ADGroupMember</span><span class="w"> </span><span class="nt">-Identity</span><span class="w"> </span><span class="s2">"grpservice"</span><span class="w"> </span><span class="nt">-Members</span><span class="w"> </span><span class="s2">"ADSyncMSAxxxx$"</span><span class="w">
</span></code></pre></div></div>

<p>Pokud by vyhledÃ¡nÃ­ selhalo, pouÅ¾ije se DN definice gMSA, AD si to sÃ¡m namapuje.</p>

<h2 id="zÃ¡vÄ›r">ZÃ¡vÄ›r</h2>
<ul>
  <li>Azure AD Connect pouÅ¾Ã­vÃ¡ gMSA, ne starÃ½ MSOL ÃºÄet.</li>
  <li><code class="language-plaintext highlighter-rouge">$</code> varianta je ta, kterou pouÅ¾Ã­vÃ¡ sluÅ¾ba.</li>
  <li>Pro pÅ™idÃ¡nÃ­ do skupiny je nutnÃ© pracovat prÃ¡vÄ› s nÃ­.</li>
  <li>StarÃ½ ÃºÄet MSOL mÅ¯Å¾eÅ¡ s klidem smazat, pokud uÅ¾ nenÃ­ v provozu.</li>
</ul>

<p>CelÃ¡ situace vznikÃ¡ jen dÃ­ky tomu, Å¾e MMC nepodÃ¡vÃ¡ ÃºplnÃ½ obraz.<br />
Jakmile ÄlovÄ›k vÃ­, co kterÃ½ objekt je, dÃ¡vÃ¡ to celÃ© perfektnÃ­ smysl.</p>
:ET